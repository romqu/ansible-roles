services:
    tailscale:
        image: tailscale/tailscale:v1.64.2
        hostname: tailscale-nas
        container_name: tailscale
        volumes:
            - tailscale-data:/var/lib/tailscale
            - /dev/net/tun:/dev/net/tun
        network_mode: host
        cap_add:
            - net_admin
            - net_raw
            - sys_module
        restart: unless-stopped
        environment:
            - TS_STATE_DIR=/var/lib/tailscale
            - TS_AUTHKEY={{ tailscale__docker_setup__auth_key }}
            - TS_HOSTNAME=tailscale-nas

volumes:
  tailscale-data:
    driver: local